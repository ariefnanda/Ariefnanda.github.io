<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Permata SPCK</title>
    <style>
        /* CSS untuk tampilan game */
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: sans-serif;
            user-select: none;
        }

        #game-area {
            width: 300px;
            height: 300px;
            border: 5px solid #333;
            background-color: #c8e6c9; /* Warna hijau muda */
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            touch-action: none; /* Penting untuk interaksi sentuh */
        }

        #player {
            width: 20px;
            height: 20px;
            background-color: #e57373; /* Warna merah */
            position: absolute;
            border-radius: 5px;
            transition: left 0.05s linear, top 0.05s linear;
        }

        .gem {
            width: 15px;
            height: 15px;
            background-color: #81c784; /* Warna hijau permata */
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 5px #81c784, 0 0 10px #81c784;
            font-size: 0; /* Sembunyikan konten jika ada */
        }

        #score-board {
            margin-bottom: 20px;
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }

        #instructions {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }
    </style>
</head>
<body>
    <div id="score-board">Skor: 0</div>
    <div id="game-area">
        <div id="player"></div>
    </div>
    <div id="instructions">
        Gunakan tombol **WASD** (desktop) atau **sentuh** di area game (mobile) untuk bergerak. Kumpulkan permata!
    </div>

    <script>
        // JavaScript untuk logika game
        const gameArea = document.getElementById('game-area');
        const player = document.getElementById('player');
        const scoreBoard = document.getElementById('score-board');
        let score = 0;
        
        // Ukuran area game dan pemain
        const AREA_SIZE = 300;
        const PLAYER_SIZE = 20;
        const GEM_SIZE = 15;
        const MOVE_STEP = 5; // Kecepatan gerakan
        const SPAWN_INTERVAL = 2000; // Interval permata muncul (ms)

        let playerX = (AREA_SIZE - PLAYER_SIZE) / 2;
        let playerY = (AREA_SIZE - PLAYER_SIZE) / 2;
        
        // Atur posisi awal pemain
        player.style.left = `${playerX}px`;
        player.style.top = `${playerY}px`;

        // Status tombol yang ditekan
        const keys = {
            'w': false,
            'a': false,
            's': false,
            'd': false
        };

        // Fungsi untuk menggerakkan pemain
        function movePlayer() {
            let dx = 0;
            let dy = 0;

            if (keys['w']) dy -= MOVE_STEP;
            if (keys['s']) dy += MOVE_STEP;
            if (keys['a']) dx -= MOVE_STEP;
            if (keys['d']) dx += MOVE_STEP;

            // Perbarui posisi dengan batas area
            playerX = Math.max(0, Math.min(AREA_SIZE - PLAYER_SIZE, playerX + dx));
            playerY = Math.max(0, Math.min(AREA_SIZE - PLAYER_SIZE, playerY + dy));

            player.style.left = `${playerX}px`;
            player.style.top = `${playerY}px`;
        }

        // Fungsi untuk mendeteksi tabrakan (koleksi permata)
        function checkCollision() {
            const gems = document.querySelectorAll('.gem');
            gems.forEach(gem => {
                const gemRect = gem.getBoundingClientRect();
                const playerRect = player.getBoundingClientRect();

                // Deteksi tabrakan sederhana (menggunakangetBoundingClientRect)
                const isCollision = !(
                    playerRect.right < gemRect.left ||
                    playerRect.left > gemRect.right ||
                    playerRect.bottom < gemRect.top ||
                    playerRect.top > gemRect.bottom
                );

                if (isCollision) {
                    collectGem(gem);
                }
            });
        }

        // Fungsi untuk mengumpulkan permata
        function collectGem(gemElement) {
            score++;
            scoreBoard.textContent = `Skor: ${score}`;
            gemElement.remove(); // Hapus permata
        }

        // Fungsi untuk memunculkan permata baru
        function spawnGem() {
            const gem = document.createElement('div');
            gem.className = 'gem';

            // Posisi acak di dalam area game
            const randomX = Math.floor(Math.random() * (AREA_SIZE - GEM_SIZE));
            const randomY = Math.floor(Math.random() * (AREA_SIZE - GEM_SIZE));

            gem.style.left = `${randomX}px`;
            gem.style.top = `${randomY}px`;

            gameArea.appendChild(gem);
        }

        // Loop game utama
        function gameLoop() {
            movePlayer();
            checkCollision();
            requestAnimationFrame(gameLoop);
        }

        // Event Listener untuk pergerakan keyboard (desktop)
        document.addEventListener('keydown', (e) => {
            const key = e.key.toLowerCase();
            if (keys.hasOwnProperty(key)) {
                keys[key] = true;
                e.preventDefault(); // Mencegah scrolling dengan spasi/panah
            }
        });

        document.addEventListener('keyup', (e) => {
            const key = e.key.toLowerCase();
            if (keys.hasOwnProperty(key)) {
                keys[key] = false;
            }
        });
        
        // Event Listener untuk pergerakan sentuh (mobile)
        let touchStart = null;
        
        gameArea.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Mencegah tindakan default browser
            if (e.touches.length > 0) {
                touchStart = {
                    x: e.touches[0].clientX,
                    y: e.touches[0].clientY
                };
            }
        });

        gameArea.addEventListener('touchmove', (e) => {
            e.preventDefault();
            if (e.touches.length > 0 && touchStart) {
                const touchEnd = {
                    x: e.touches[0].clientX,
                    y: e.touches[0].clientY
                };

                const gameRect = gameArea.getBoundingClientRect();
                
                // Hitung posisi pemain berdasarkan sentuhan relatif terhadap area game
                let newPlayerX = touchEnd.x - gameRect.left - (PLAYER_SIZE / 2);
                let newPlayerY = touchEnd.y - gameRect.top - (PLAYER_SIZE / 2);

                // Batasi posisi pemain
                playerX = Math.max(0, Math.min(AREA_SIZE - PLAYER_SIZE, newPlayerX));
                playerY = Math.max(0, Math.min(AREA_SIZE - PLAYER_SIZE, newPlayerY));

                player.style.left = `${playerX}px`;
                player.style.top = `${playerY}px`;
                
                // Pada mobile, gerakan dilakukan secara langsung pada touchmove
                checkCollision();
            }
        });

        gameArea.addEventListener('touchend', () => {
            touchStart = null;
        });


        // Mulai game
        gameLoop();
        
        // Mulai memunculkan permata secara berkala
        setInterval(spawnGem, SPAWN_INTERVAL);
        
        // Tambahkan permata pertama segera
        spawnGem(); 
    </script>
</body>
</html>